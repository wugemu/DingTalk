window.AlipayH5Performance||function(){function e(e){var n=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);return(n?parseInt(n[2],10):0)>=49?(new Date).getTime():e.timeStamp?e.timeStamp:(new Date).getTime()}function n(e){return Object.prototype.toString.call(e).replace(/\[object (\w+)\]/,"$1").toLowerCase()}var t=window.__alipayConsole__||window.console,a=t.log,o=function(e){a.call(t,"h5container.message: "+e)},i={},r={},s={init:function(){this.init=null,this.monitorDOMReady(),this.monitorPageLoad(),this.monitorNavigationStart(),window.ucweb&&this.monitorHeadScreen(),this.monitorJSErrors(),this.monitorDNSTime(),this.monitorCacheRate(),this.monitorMixedContent()},monitorDOMReady:function(){var n=this;/complete|loaded|interactive/.test(document.readyState)?(n.pushMessage("monitor",{name:"domReady",value:(new Date).getTime(),extra:"completed"}),n.sendSignal()):document.addEventListener("DOMContentLoaded",function(t){n.pushMessage("monitor",{name:"domReady",value:e(t),extra:"complete"}),n.sendSignal()},!0)},monitorPageLoad:function(){var n=function(e){var n=""+(new Date).getTime()+Math.random();invokeMsg=JSON.stringify({func:"monitorH5Performance",param:{data:[{name:"pageLoad",value:e,extra:"load"}]},msgType:"call",clientId:n}),o(invokeMsg)};/complete|loaded|interactive/.test(document.readyState)?n((new Date).getTime()):window.addEventListener("load",function(t){n(e(t))},!0)},monitorNavigationStart:function(){var e=this;/complete|loaded|interactive/.test(document.readyState)?window.performance&&window.performance.timing&&(e.pushMessage("monitor",{name:"navigationStart",value:window.performance.timing.navigationStart}),e.sendSignal()):window.addEventListener("load",function(n){window.performance&&window.performance.timing&&(e.pushMessage("monitor",{name:"navigationStart",value:window.performance.timing.navigationStart}),e.sendSignal())},!0)},monitorHeadScreen:function(){window.ucweb.window.addEventListener("BacktracePaintReady",function(){if(window&&window.ucweb){var e=window.ucweb.window.performance,n=""+(new Date).getTime()+Math.random(),t=JSON.stringify({func:"monitorH5Performance",param:{data:[{name:"headScreen",value:e.t2?e.t2+performance.timing.navigationStart:0,extra:"BacktracePaintReady"}]},msgType:"call",clientId:n});o(t),e.t2=0}},!1)},monitorJSErrors:function(){var e=this;window.addEventListener("error",function(n){n.message&&(e.pushMessage("monitor",{name:"jsErrors",value:n.message,filename:n.filename,lineno:n.lineno,colno:n.colno,date:n.timeStamp}),e.sendSignal())},!0)},monitorDNSTime:function(){var e=this;window.addEventListener("load",function(n){window.performance&&window.performance.timing?e.pushMessage("monitor",{name:"dns",value:window.performance.timing.domainLookupEnd-window.performance.timing.domainLookupStart,extra:"support"}):e.pushMessage("monitor",{name:"dns",value:"",extra:"notsupport"}),e.sendSignal()},!0)},monitorMixedContent:function(){var e=this,n=[];/complete|loaded|interactive/.test(document.readyState)?("https:"==window.location.protocol&&[].slice.call(document.querySelectorAll('link[rel=stylesheet][href^="http:"], script[src^="http:"]')).forEach(function(e){n.push(e.tagName+":"+(e.src||e.href))}),n.length>0&&(e.pushMessage("monitor",{name:"mixedContent",value:n.join("@|@")}),e.sendSignal())):document.addEventListener("DOMContentLoaded",function(t){"https:"==window.location.protocol&&[].slice.call(document.querySelectorAll('link[rel=stylesheet][href^="http:"], script[src^="http:"]')).forEach(function(e){n.push(e.tagName+":"+(e.src||e.href))}),n.length>0&&(e.pushMessage("monitor",{name:"mixedContent",value:n.join("@|@")}),e.sendSignal())},!0)},monitorCacheRate:function(){var e,n=this,t={name:"cacheRate"};window.addEventListener("load",function(a){if(window.performance&&"function"==typeof window.performance.getEntriesByType&&(e=window.performance.getEntriesByType("resource"))){if(e.length>0){for(var o=0,i=0;i<e.length;i++)0===e[i].duration&&o++;t.value=(o/e.length).toFixed(4)}else t.value=0;t.extra="support"}else t.value="",t.extra="notsupport";n.pushMessage("monitor",t),n.sendSignal()},!0)},sendSignal:function(e,n){var t=this;e="number"==typeof e&&e>=0?e:500,n=n||"monitor",clearTimeout(r[n]),r[n]=setTimeout(function(){var e=""+(new Date).getTime()+Math.random(),a=JSON.stringify({func:"report"==n?n+"H5Abnormal":n+"H5Performance",param:{data:t.getMessage(n)},msgType:"call",clientId:e});o(a)},e)},pushMessage:function(e,t){e=e||"monitor",i&&"array"==n(i[e])||(i[e]=[]),i[e].push(t)},getMessage:function(e){e=e||"monitor",i&&"array"==n(i[e])||(i[e]=[]);var t=i[e];return i[e]=[],t}};s.init(),window.AlipayH5Performance={addTrackData:function(e,n){n=n||"monitor",e.value&&(e.value+="|time="+(new Date).getTime()),s.pushMessage(n,e),s.sendSignal(0)},reportBizReady:function(e){var n="number"==typeof e?e:Date.now();s.pushMessage("monitor",{name:"availableTime",value:""+n}),s.sendSignal(0)},addTimeReport:function(e){var n="";for(var t in e)n+=(""==n?"":"&")+t+"="+e[t];this.addTrackData({name:"timeReport",value:n})},pushMessage:function(e,n){s.pushMessage(e,n)},sendSignal:function(e){s.sendSignal(0,e)},init:function(){var e=window.PERF_BIZ_READY;e&&this.reportBizReady(e)},version:"1.2"},window.AlipayH5Performance.init()}();
// do not modify
